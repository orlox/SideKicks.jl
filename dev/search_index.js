var documenterSearchIndex = {"docs":
[{"location":"2_plot_results/#Plotting-MCMC-results-from-VFTS-243","page":"Plotting MCMC results from VFTS 243","title":"Plotting MCMC results from VFTS 243","text":"In this example we produce corner plots from the results of VFTS 243 that were stored from the previous example. We start by loading up\n\nusing CairoMakie\nusing SideKicks\nusing CornerPlotting\nusing Distributions\n\nresults, observations, priors, metadata = SideKicks.ExtractResults(\"vfts243_results.hdf5\");\nnothing #hide\n\nAs an initial check, we can plot the quantities that were used as observations. A basic consistency check is to verify these are consistent with the MCMC samples.\n\nnames = [:m1_f, :P_f, :e_f, :K1]\nscaling = Dict( :m1_f => m_sun,\n                :P_f  => day,\n                :e_f  => 1,\n                :K1   => km_per_s\n               )\nlabels  = Dict( :m1_f => L\"M_{1f}\\;[M_{\\odot}]\",\n                :P_f  => L\"P_f\\;[\\mathrm{days}]\",\n                :e_f  => L\"e_f\",\n                :K1   => L\"K_1  \\;[\\mathrm{km s}^{-1}]\",\n               )\n\nset_theme!(CornerPlotting.default_theme())\ncp = CornerPlotting.CornerPlot(results, names, scaling=scaling, labels=labels, nbins=10, nbins_contour=10)\n\nCornerPlotting.plot_extra_1D_distribution(cp, :m1_f, Normal(25.0,2.3))\nCornerPlotting.plot_extra_1D_distribution(cp, :e_f,  Normal(0.017,0.012))\nCornerPlotting.plot_extra_1D_distribution(cp, :K1,   Normal(81.4, 1.3))\nCornerPlotting.plot_extra_1D_distribution(cp, :P_f,  Normal(10.4031, 0.01))\n\nsave(\"vfts243_observables.png\", cp.fig)\n\ncp.fig\n\nAnd, after verifying the samples do correspond to our observational constraints, we can analyze the consequences for explosion itself.\n\nnames = [:m2_i, :dm2, :P_i, :vkick, :vsys]\nscaling = Dict( :m2_i  => m_sun,\n                :dm2   => m_sun,\n                :P_i   => day,\n                :vkick => km_per_s,\n                :vsys  => km_per_s,\n               )\nlabels = Dict( :m2_i => L\"M_{2f}\\;[M_{\\odot}]\",\n               :dm2   =>  L\"ΔM_2  \\;[M_{\\odot}]\",\n               :P_i   =>  L\"P_i \\;[\\mathrm{days}]\",\n               :vkick =>  L\"v_{kick}  \\;[\\mathrm{km s}^{-1}]\",\n               :vsys  =>  L\"v_{\\mathrm{sys}} \\;[\\mathrm{km s}^{-1}]\",\n              )\n\n\nset_theme!(CornerPlotting.default_theme())\ncp = CornerPlotting.CornerPlot(results, names, scaling=scaling, labels=labels, nbins=10, nbins_contour=10)\n\nsave(\"vfts243_derived.png\", cp.fig)\n\ncp.fig\n\nAs you might see, the results are not very flattering, but this is a consequence of the very small number of samples used.\n\n\n\nThis page was generated using Literate.jl.","category":"section"},{"location":"1_run_inference/#Inference-example-for-VFTS-243","page":"Inference example for VFTS 243","title":"Inference example for VFTS 243","text":"In this example we try to match the observed properties of VFTS 243. We start by loading up the SideKicks package, as well the Distributions package which we use to define the priors.\n\nusing SideKicks\nusing Distributions\n\nWe set up our observations using the @Observations macro. This macro will return a tuple containing an instance of Observation, as well as a string with the code needed to initialize the Observation instance. The reason for this is that when we save results, we also want to save the precise observations that were used for the MCMC.\n\nCurrently, The likelihoods are taken to be Normal distributions. This can potentially be generalized in the future to arbitrary user-defined likelihood functions.\n\nobs = SideKicks.@Observations([\n    [:P_f,  10.4031, 0.01,   day],\n    [:e_f,  0.017,   0.012,  1],\n    [:m1_f, 25.0,    2.3,    m_sun],\n    [:K1,   81.4,    1.3,    km_per_s],\n    [:v_N,  138.8,    7.6,     km_per_s], # Gaia 4' w/ MCMC\n    [:v_E,  409.3,    9.3,     km_per_s], # Gaia 4' w/ MCMC\n    [:v_r,  261.5,   0.42,    km_per_s], # Almeida\n    [:ω_f,  66,      53,     degree]\n])\n\nNext, we choose our priors. In here we are using distributions defined in the Distributions.jl` package.\n\npriors = SideKicks.@Priors(\n    logm1_dist = Uniform(0.1,3), # in log(Msun)\n    logm2_dist = Uniform(0.1,3), # in log(Msun)\n    logP_dist  = Uniform(-1,3),   # in log(days)\n    vkick_dist = Uniform(0,4), # in 100 km/s\n    frac_dist  = Uniform(0,1.0),\n    e_dist = Uniform(0,0.01),\n    venv_N_100kms_dist = Normal(146/100, 40/100), # Gaia 4' w/ MCMC\n    venv_E_100kms_dist = Normal(393/100, 42/100), # Gaia 4' w/ MCMC\n    venv_r_100kms_dist = Normal(270.3/100, 11.1/100) # Almeida w/ MCMC\n)\n\nFinally, we run the MCMC using the NUTS algorithm. In the example below we are computing 3 chains with 100 samples each. This in practice is very low, and a ballpark suggestion would be to total at least sim10^4 samples for any meaningful analysis, and an order of magnitude higher for final science runs.\n\nkick_mcmc = SideKicks.KickMCMC(\n        which_model = :general,\n        observations = obs,\n        priors = priors,\n        nuts_warmup_count = 500,\n        nuts_acceptance_rate = 0.8,\n        nsamples = 1000,\n        nchains = 4);\nnothing #hide\n\nResults from the MCMC can be saved to an HDF5 file. In practice, it is ideal to separate the computation of the MCMC and its analysis, so plotting of the results is done separetely.\n\nSideKicks.SaveResults(\"vfts243_results.hdf5\", kick_mcmc)\n\n\n\nThis page was generated using Literate.jl.","category":"section"},{"location":"#SideKicks","page":"Home","title":"SideKicks","text":"Documentation for SideKicks, a Julia package for analyzing the observed properties of stellar binaries containing a compact object, in order to perform parameter inference on the supernova mass loss and natal kick. ","category":"section"},{"location":"#Package-features","page":"Home","title":"Package features","text":"","category":"section"},{"location":"##-TODO-RTW","page":"Home","title":"# TODO - RTW","text":"","category":"section"},{"location":"#Index","page":"Home","title":"Index","text":"","category":"section"},{"location":"#SideKicks.SideKicks","page":"Home","title":"SideKicks.SideKicks","text":"Main module for SideKicks.jl – a analysis package for performing parameter inference on compact object stellar binaries.\n\n\n\n\n\n","category":"module"},{"location":"#SideKicks.KickMCMC","page":"Home","title":"SideKicks.KickMCMC","text":"mutable struct KickMCMC\n\nKickMCMC contains the MCMC model and Observations structs, the Results dict, the chains that resulted from the MCMC, and the parameters that went into the sampler.\n\n\n\n\n\n","category":"type"},{"location":"#SideKicks.ModVonMises","page":"Home","title":"SideKicks.ModVonMises","text":"struct ModVonMises{T1<:Real, T2<:Real} <: ContinuousUnivariateDistribution\n\nThis is just a wrapper on top of the VonMises distribution (as defined in Distributions.jl) to extend its domain. This is because the domain of VonMises is defined to be [μ-π, μ+π], and the angles we are concerned with range from [0,2π]\n\n\n\n\n\n","category":"type"},{"location":"#SideKicks.Observations","page":"Home","title":"SideKicks.Observations","text":"mutable struct Observations\n\nObservations contains the symbols, values, errors, and units of each observed parameter.\n\n\n\n\n\n","category":"type"},{"location":"#SideKicks.Priors","page":"Home","title":"SideKicks.Priors","text":"mutable struct Priors\n\nPriors contains the prior distribution of each of the desired parameters\n\n\n\n\n\n","category":"type"},{"location":"#SideKicks.WrappedCauchy","page":"Home","title":"SideKicks.WrappedCauchy","text":"struct WrappedCauchy{T1<:Real, T2<:Real} <: ContinuousUnivariateDistribution\n\nThe WrappedCauchy distribution resembles the Cauchy distribution defined on the unit  circle from 0 to 2π, with the endpoints wrapped back to each other.\n\n\n\n\n\n","category":"type"},{"location":"#SideKicks.RV_semiamplitude_K1-Tuple{}","page":"Home","title":"SideKicks.RV_semiamplitude_K1","text":"RV_semiamplitude_K1(;m1, m2, P, e, i)\n\nCompute the amplitude of radial velocity variations given orbital parameters and masses\n\nArguments:\n\nm1:   mass of observed star             [g]\nm2:   mass of companion                 [g]\nP:    orbital period                    [s]\ne:    orbital eccentricity              [-]\ni:    orbital inclination               [rad]\n\nOutput:\n\nK1: amplitude of radial velocity variation of star 1  [cm/s]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.arbitraryEjectaBH-Tuple{Any, Any}","page":"Home","title":"SideKicks.arbitraryEjectaBH","text":"arbitraryEjectaBH(m2_i, frac)\n\n#TODO Description\n\nArguments:\n\n#TODO\n\nm2_i:\nfrac:\n\nOutput:\n\n#TODO\n\n\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.create_corner_plot-Tuple{Any, Any}","page":"Home","title":"SideKicks.create_corner_plot","text":"create_corner_plot(results, plotting_props; \n    observations=nothing, fig=Figure(), supertitle=nothing,\n    fractions=[0.68,0.95,0.997], fraction_1D=0.68, \n    show_CIs=true, nbins=100, nbins_contour=20, rowcolgap=10, \n    xticklabelrotation=pi/4, labelfontsize=16, tickfontsize=10, supertitlefontsize=30)\n\nDescription Function to create corner plot for selected (sub-)set of parameters from the MCMC output.\n\nArguments:\n\nresults:             the extracted results hdf5 object from a previous MCMC run                  \nplotting_props:      the plotting properties object containing which properties and ranges to plot                  \nobservations:        any observations that should be included in the plots for comparison          \nfig:                 a figure, if needed\nsupertitle:          the title of the plot          \nfractions:           the area fraction to determine different colored regions \nfraction_1D:         the area fraction to include in the confidence interval bounds\nshow_CIs:            whether to include confidence intervals\nnbins:               number of bins, identical for all parameters   \nnbins_contour:       number of bins for the contour plots\nrowcolgap:           spacing between the axes\nxticklabelrotation:  rotating (in rad) of the x-axis tick labels                \nlabelfontsize:       fontsize of the parameter labels           \ntickfontsize:        fontsize of the tick labels\nsupertitlefontsize:  fontsize of the title\n\nOutput:\n\nfig:                 the newly created figure \n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.create_general_mcmc_model-Tuple{}","page":"Home","title":"SideKicks.create_general_mcmc_model","text":"create_general_mcmc_model(observations, observed_values, observed_errors)\n\nCreate a Turing model to perform an MCMC sampling of the pre-explosion  and kick properties of a system, assuming pre-explosion eccentricity.\n\nRTW does acos just work? Do I need to worry about domain/range issues?\n\nCheck velocities, the conversions are a bit funky\n\nArguments:\n\nobservations:    the parameters taken from observations [Vector{Symbol}]\nobserved_values: the values of the parameters           [Vector{Float64}] \nobserved_errors: the errors of the observations         [Vector{Float64}]\n\nOutput:\n\nkickmodel: A Turing model for sampling\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.create_simplified_mcmc_model-Tuple{}","page":"Home","title":"SideKicks.create_simplified_mcmc_model","text":"create_simplified_mcmc_model(observations, observed_values, observed_errors)\n\nDescription Create a Turing model to perform an MCMC sampling of the pre-explosion  and kick properties of a system, assuming pre-explosion circularity.\n\nRTW this is more simplistic than just using a circular model, it's also assuming you know the eccentricity and don't care about radial velocity etc.\n\nArguments:\n\nobservations:    the parameters taken from observations [Vector{Symbol}]\nobserved_values: the values of the parameters           [Vector{Float64}] \nobserved_errors: the errors of the observations         [Vector{Float64}]\n\nOutput:\n\nkickmodel: A Turing model for sampling\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.kepler_P_from_a-Tuple{}","page":"Home","title":"SideKicks.kepler_P_from_a","text":"kepler_P_from_a(;m1, m2, a)\n\nObtain period from semimajor axis using Kepler's third law\n\nArguments:\n\nm1: mass of first companion      [g]\nm2: mass of 2nd companion        [g]\na:  semi-major axis of the orbit [cm]\n\nOutput:\n\nP: the orbital period            [s]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.kepler_a_from_P-Tuple{}","page":"Home","title":"SideKicks.kepler_a_from_P","text":"kepler_a_from_P(;m1, m2, P)\n\nObtain semimajor axis from period using Kepler's third law\n\nArguments:\n\nm1: mass of first companion [g]\nm2: mass of 2nd companion   [g]\nP:  orbital period          [s]\n\nOutput:\n\na: semi-major axis of the orbit [cm]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.post_supernova_circular_orbit_P-Tuple{}","page":"Home","title":"SideKicks.post_supernova_circular_orbit_P","text":"post_supernova_circular_orbit_P(;m1_i, m2_i, P_i, m1_f=-1, m2_f, vkick=0, θ=0, ϕ=0, vimp=0)\n\nSame as post_supernova_circular_orbit_a, except that it receives the initial orbital period as input and returns the final orbital period and eccentricity.\n\nArguments:\n\nm1_i:  pre-explosion  mass of non-exploding component [g]           \nm2_i:  pre-explosion  mass of exploding component     [g]       \nP_i:   pre-explosion orbital period                   [d]\nm1_f:  post-explosion mass of non-exploding component [g]           \nm2_f:  post-explosion mass of exploding component     [g]   \nvkick: kick velocity                                  [cm/s] \nθ:     polar kick angle (away from e_par)             [rad]\nϕ:     azimuthal kick angle (off of e_perp)           [rad]\nvimp:  imparted kick velocity on companion            [cm/s]     \n\nOutput:\n\nP_f: post-explosion orbital period                    [d]\ne_f: post-explosion excentricity                      [-]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.post_supernova_circular_orbit_a-Tuple{}","page":"Home","title":"SideKicks.post_supernova_circular_orbit_a","text":"post_supernova_circular_orbit_a(;m1_i, m2_i, a_i, m1_f=-1.0, m2_f, vkick=0.0, θ=0.0, ϕ=0.0, vimp=0.0)\n\nCompute post-kick properties for a circular pre-explosion orbit. Equivalent to Tauris et al. (1999): Monthly Notices of the Royal Astronomical Society, Volume 310, Issue 4, pp. 1165-1169.\n\nArguments:\n\nm1_i:  pre-explosion  mass of non-exploding component [g]           \nm2_i:  pre-explosion  mass of exploding component     [g]       \na_i:   pre-explosion orbital separation               [cm]\nm1_f:  post-explosion mass of non-exploding component [g]           \nm2_f:  post-explosion mass of exploding component     [g]   \nvkick: kick velocity                                  [cm/s] \nθ:     polar kick angle (away from e_par)             [rad]\nϕ:     azimuthal kick angle (off of e_perp)           [rad]\nvimp:  imparted kick velocity on companion            [cm/s]     \n\nOutput:\n\na_f: post-explosion orbital separation                [cm]\ne_f: post-explosion excentricity                      [-]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.post_supernova_circular_orbit_vsys-Tuple{}","page":"Home","title":"SideKicks.post_supernova_circular_orbit_vsys","text":"post_supernova_circular_orbit_vsys(;m1_i, m2_i, a_i, m1_f=-1, m2_f, vkick=0, θ=0, ϕ=0, vimp=0)\n\nCompute post-kick systemic velocity for a circular orbit Tauris et al. (1999): Monthly Notices of the Royal Astronomical Society, Volume 310, Issue 4, pp. 1165-1169.\n\nArguments:\n\nm1_i:  pre-explosion  mass of non-exploding component   [g]           \nm2_i:  pre-explosion  mass of exploding component       [g]       \na_i:   pre-explosion orbital separation                 [cm]\nm1_f:  post-explosion mass of non-exploding component [g]           \nm2_f:  post-explosion mass of exploding component     [g]   \nvkick: kick velocity                                  [cm/s] \nθ:     polar kick angle (away from e_par)             [rad]\nϕ:     azimuthal kick angle (off of e_perp)           [rad]\nvimp:  imparted kick velocity on companion            [cm/s]     \n\nOutput:\n\nvsys_f: post-explosion systemic velocity              [cm/s]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.post_supernova_general_orbit_parameters-Tuple{}","page":"Home","title":"SideKicks.post_supernova_general_orbit_parameters","text":"post_supernova_general_orbit_parameters(;m1_i, m2_i, a_i, e_i=0, m1_f=-1, m2_f, vkick=0, θ=0, ϕ=0, vimp=0,\n    ν_i=0, Ω_i=0, ω_i=0, i_i=0)\n\nCompute post-kick properties for a general pre-explosion orbit  using equations from [Marchant, Willcox, Vigna-Gomez] TODO\n\nArguments:\n\nm1_i:  pre-explosion  mass of non-exploding component  [g]           \nm2_i:  pre-explosion  mass of exploding component      [g]       \na_i:   pre-explosion orbital separation                [cm]\ne_i:   pre-explosion orbital eccentricity              [-]\nm1_f:  post-explosion mass of non-exploding component  [g]           \nm2_f:  post-explosion mass of exploding component      [g]   \n\nvkick: kick velocity                                   [cm/s] \nθ:     polar kick angle (away from e_par)              [rad]\nϕ:     azimuthal kick angle (off of e_perp)            [rad]\nvimp:  imparted kick velocity on companion             [cm/s]     \nInitial orbital orientation angles: \nν_i: true anomaly                                       [rad]\nΩ_i: pre-explosion longitude of the ascending node      [rad]\nω_i: pre-explosion argument of periastron               [rad]\ni_i: pre-explosion inclination                          [rad]\na_f:     post-explosion orbital separation                  [cm]\ne_f:     post-explosion orbital eccentricity                [-]\nΩ_f:     post-explosion longitude of ascending node         [rad]      \nω_f:     post-explosion argument of periastron              [rad]    \ni_f:     post-explosion inclination                         [rad]     \nvCM_n:   post-explosion systemic velocity, toward N         [rad]\nvCM_w:   post-explosion systemic velocity, toward W         [rad]      \nvCM_rad: post-explosion radial velocity, toward negative O  [rad]      \n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.relative_velocity-Tuple{}","page":"Home","title":"SideKicks.relative_velocity","text":"relative_velocity(;m1, m2, a)\n\nCalculate the relative orbital velocity for a circular orbit.\n\nArguments:\n\nm1: mass of first companion        [g]\nm2: mass of 2nd companion          [g]\na:  semi-major axis of the orbit   [cm]\n\nOutput:\n\nv_rel: the relative velocity [cm/s]\n\n\n\n\n\n","category":"method"},{"location":"#SideKicks.restrictedEjectaBH-Tuple{Any, Any}","page":"Home","title":"SideKicks.restrictedEjectaBH","text":"restrictedEjectaBH(m2_i, frac; Ma=10, Mb=15, max_frac=1.0, min_frac=0.1)\n\n#TODO Description\n\nArguments:\n\n#TODO\n\nm2_i:\nfrac:\nMa=10:\nMb=15:\nmax_frac=1.0:\nmin_frac=0.1:\n\nOutput:\n\n#TODO\n\n\n\n\n\n\n\n","category":"method"}]
}
